(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[189],{4124:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mypage/notification",function(){return s(8717)}])},6874:function(e,t,s){"use strict";var l=s(5893),i=s(9008),n=s.n(i),a=s(7294),c=s(1163),r=s(5610);let o=e=>{let{title:t,children:s,isSetUpOGP:i=!0,isTitleHidden:o=!1,isAuthPageHidden:d=!1,loading:x=!1}=e,{push:m}=(0,c.useRouter)();return(0,a.useEffect)(()=>{d&&!x&&m("/signin")},[d,x,m]),(0,l.jsxs)(l.Fragment,{children:[i&&(0,l.jsxs)(n(),{children:[(0,l.jsx)("title",{children:t}),(0,l.jsx)("meta",{property:"og:title",content:t})]}),(0,l.jsxs)("div",{className:"w-[100vw] flex flex-col items-center",children:[!o&&(0,l.jsx)("h1",{className:"text-2xl my-6 font-bold w-[100vw] text-center",children:t}),x&&(0,l.jsx)(r.$,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}),(!d||!x)&&s]})]})};t.Z=o},2038:function(e,t,s){"use strict";s.d(t,{P:function(){return d}});var l=s(5893),i=s(3345),n=s(8641),a=s(9417),c=s(9603),r=s(1163),o=s(4523);let d=e=>{let{user:t,display:s}=e,d=(0,r.useRouter)(),x=(0,o.G)(t);return(0,l.jsx)("div",{className:"w-1/4 flex hidden md:block",children:(0,l.jsxs)("div",{className:"mr-[calc((100%-210px)/2)] ml-[calc((100%-210px)/2+2rem)] flex w-[210px] h-max flex-col items-center justify-center shadow-lg gap-2 mt-12 rounded-md",children:[(0,l.jsx)(i.qE,{flexShrink:0,width:10,height:10,src:(null==t?void 0:t.photoURL)||"default_image_url",mt:4}),(0,l.jsx)("p",{children:null==t?void 0:t.displayName}),(0,l.jsx)(n.iz,{}),(0,l.jsxs)("div",{className:"flex flex-col items-start justify-center gap-2 my-4 px-4",children:[(0,l.jsxs)("button",{className:" flex items-center gap-1.5 ".concat("profile"===s?"text-black":"text-gray-500"),onClick:()=>d.push("/mypage/profile"),children:[(0,l.jsx)(c.G,{icon:a.ILF,size:"xs",className:"h-3 w-3"}),(0,l.jsx)("span",{children:"プロフィール"})]}),(0,l.jsxs)("button",{className:" flex items-center gap-1.5\n              ".concat("posted"===s?"text-black":"text-gray-500","\n            "),onClick:()=>d.push("/mypage/posted"),children:[(0,l.jsx)(c.G,{icon:a.gMD,size:"xs",className:"h-3 w-3"}),(0,l.jsx)("span",{children:"投稿済みアンケート"})]}),(0,l.jsxs)("button",{className:" flex items-center gap-1.5\n              ".concat("answered"===s?"text-black":"text-gray-500","\n            "),onClick:()=>d.push("/mypage/answered"),children:[(0,l.jsx)(c.G,{icon:a.chG,size:"xs",className:"h-3 w-3"}),(0,l.jsx)("span",{children:"回答済みアンケート"})]}),(0,l.jsxs)("button",{className:" flex items-center gap-1.5\n              ".concat("notification"===s?"text-black":"text-gray-500","\n            "),onClick:()=>d.push("/mypage/notification"),children:[(0,l.jsx)(c.G,{icon:a.qmU,size:"xs",className:"h-3 w-3"}),(0,l.jsx)("span",{children:"あなたへのお知らせ"}),x&&(0,l.jsx)("div",{className:"absolute ml-[0.4rem] mb-2 border-white border text-xs md:text-sm text-gray-500 w-[0.6rem] h-[0.6rem] bg-[#38a169] rounded-full"})]})]})]})})}},8717:function(e,t,s){"use strict";s.r(t),s.d(t,{NotificationPage:function(){return f},default:function(){return p}});var l=s(5893),i=s(1734),n=s(7021),a=s(552),c=s(6874),r=s(1586);let o=e=>{let t=new Date,s=e.toDate(),l=t.getTime()-s.getTime();if(l<36e5)return"".concat(Math.floor(l/6e4),"分前");if(l<864e5)return"".concat(Math.floor(l/36e5),"時間前");if(l<6048e5)return"".concat(Math.floor(l/864e5),"日前");let i=s.getMonth()+1,n=s.getDate();return"".concat(i,"/").concat(n)},d=e=>{let{log:t,owner:s,bagde:i}=e,{user:n}=(0,r.T)(t.respondentGmail),{questionnaire:c}=(0,a.Ff)(t.formId);return(0,l.jsxs)("div",{className:" flex items-center ml-12 py-2 gap-4",children:[i&&(0,l.jsx)("div",{className:"text-xs md:text-sm text-gray-500 w-[0.5rem] h-[0.5rem] bg-[#38a169] rounded-full"}),(0,l.jsx)("span",{className:"text-xs md:text-sm text-gray-500 ml-2 ",children:o(t.createdTime)}),s?(0,l.jsxs)("p",{className:"text-sm md:text-base text-start text-black",children:["「",null==c?void 0:c.title,"」への回答が確認されました。"]}):(0,l.jsxs)("p",{className:"text-sm md:text-base text-start text-black",children:[null==n?void 0:n.displayName,"さんが「",null==c?void 0:c.title,"」に回答しました。"]})]})};var x=s(2038),m=s(8641),u=s(9828),h=s(7294);let f=()=>{let{user:e}=(0,i.E)(),{user:t,loading:s}=(0,r.s)(null==e?void 0:e.uid),{answerLogs:o,loading:f}=(0,n.jX)((null==t?void 0:t.email)||""),{questionnaires:p}=(0,a.bh)(null==t?void 0:t.id),g=p.map(e=>e.id),{answerLogs:j}=(0,n.ep)(g),v=[...o,...j].sort((e,t)=>t.createdTime.toDate().getTime()-e.createdTime.toDate().getTime()),N=async()=>{if(null==t?void 0:t.id){let e=(0,u.ad)(),s=(0,u.JU)(e,"users",t.id);await (0,u.r7)(s,{lastNotificationCheckTime:new Date})}};return(0,h.useEffect)(()=>{N()},[null==t?void 0:t.id]),(0,l.jsx)(c.Z,{title:"あなたへのお知らせ",isTitleHidden:!0,loading:s||f,children:(0,l.jsxs)("div",{className:"w-screen flex ",children:[(0,l.jsx)(x.P,{user:t||void 0,display:"notification"}),(0,l.jsx)("div",{className:"md:w-3/4 md:p-12 w-full",children:(0,l.jsxs)("div",{className:"w-full flex flex-col items-center",children:[(0,l.jsx)("h1",{className:"text-xl md:text-2xl font-bold mt-4",children:"あなたへのお知らせ"}),(0,l.jsx)("div",{className:"w-full mt-4",children:v.map(e=>{var s;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d,{log:e,owner:e.respondentGmail===(null==t?void 0:t.email),bagde:!((null==t?void 0:t.lastNotificationCheckTime)&&e.createdTime.toDate().getTime()<(null==t?void 0:null===(s=t.lastNotificationCheckTime)||void 0===s?void 0:s.toDate().getTime()))},e.id),(0,l.jsx)(m.iz,{})]})})})]})})]})})};var p=f}},function(e){e.O(0,[774,888,179],function(){return e(e.s=4124)}),_N_E=e.O()}]);