(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[244],{4917:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mypage/answered",function(){return t(9211)}])},6280:function(e,s,t){"use strict";t.d(s,{S:function(){return b}});var l=t(5893),n=t(8641),i=t(2588),c=t(3345),a=t(9417),r=t(9603),d=t(1586),o=t(7294),x=t(7021),m=t(4221),u=t(6696),h=t(1163),j=t(6799);let f=e=>{let s="".concat("https://script.google.com/macros/s/AKfycbzdlwrxbTb_mfCPvXqIcP5SivAvtEpeRNPGxjeiy9DZwEwJfGFv30RDZhjf-faIm67n/exec","?formId=").concat(e);window.open(s,"_blank")},p=e=>{let s=e.toDate(),t=s.getMonth()+1,l=s.getDate(),n=s.getHours(),i="0".concat(s.getMinutes()).slice(-2);return"".concat(t,"/").concat(l,"  ").concat(n,":").concat(i)};var g=t(9828);let w=()=>{let e=(0,o.useCallback)(async(e,s)=>{let t=(0,g.ad)(),l=(0,g.JU)(t,e,s);try{await (0,g.oe)(l),console.log("Document successfully deleted!")}catch(n){console.error("Error removing document: ",n)}},[]);return e},b=e=>{var s,t;let{questionnaire:g,user:b}=e,{user:N,loading:v}=(0,d.s)(g.userId),{answerLogs:y,loading:T}=(0,x.jX)((null==b?void 0:b.email)||"");(0,o.useEffect)(()=>{},[v,T]);let k=y.some(e=>e.formId===g.id)&&y.length>0,C=(0,m.pm)(),_=(0,h.useRouter)(),E=w(),I=g.userId===(null==b?void 0:b.id),S=async e=>{await E("questionnaires",e),C({title:"削除しました。",status:"success",position:"top"}),_.reload()},z=async e=>{_.push("/questionnaire/edit/".concat(e))},G=async e=>{await (0,j.Z)(e),C({title:"更新しました。",status:"success",position:"top"}),setTimeout(()=>{_.reload()},200)};return(0,l.jsxs)(n.xu,{borderWidth:"1px",borderRadius:"lg",overflow:"hidden",p:4,mb:4,w:"100%",children:[(0,l.jsxs)(n.xu,{p:2,bg:"gray.100",borderRadius:"md",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"ml-2 font-bold text-sm md:text-base",children:g.title}),I?g.isAuthenticated?(0,l.jsx)(n.Ct,{colorScheme:"green",className:"ml-1 mr-6text-xs md:text-sm",children:"認証済"}):(0,l.jsx)(n.Ct,{colorScheme:"red",className:"ml-1 mr-6 ttext-xs md:text-sm",children:"未認証"}):k?(0,l.jsx)(n.Ct,{colorScheme:"green",className:"ml-1 mr-6 ttext-xs md:text-sm",children:"回答済"}):(0,l.jsx)(n.Ct,{colorScheme:"red",className:"ml-1 mr-6 text-xs md:text-sm",children:"未回答"})]}),I?(0,l.jsxs)("div",{className:"flex items-center",children:[g.isAuthenticated?(0,l.jsx)(l.Fragment,{}):(0,l.jsxs)("button",{onClick:()=>f(g.id),className:"flex items-center bg-blue-500 text-white rounded-md px-2 py-1 mr-2 font-semibold text-xs md:text-sm",children:[(0,l.jsx)("span",{children:"認証する"}),(0,l.jsx)(r.G,{icon:a.wlW,size:"xs",className:"w-2.5 ml-1"})]}),(0,l.jsx)("button",{onClick:()=>z(g.id),children:(0,l.jsx)(r.G,{icon:a.Yai,size:"xs",className:"h-3 w-3 mx-2"})}),(0,l.jsx)("button",{onClick:()=>{confirm("削除しますか？")&&S(g.id)},children:(0,l.jsx)(r.G,{icon:a.$aW,size:"xs",className:"h-3 w-3 ml-2"})})]}):k?(0,l.jsxs)("p",{className:"text-xs md:text-sm",children:["回答日時：",p(null===(s=y[0])||void 0===s?void 0:s.createdTime)]}):(0,l.jsxs)("button",{onClick:()=>window.open(g.url,"_blank"),className:"flex items-center bg-blue-500 text-white rounded-md px-2 py-1 text-xs md:text-sm font-semibold",children:[(0,l.jsx)("span",{children:"回答する"}),(0,l.jsx)(r.G,{icon:a.wlW,size:"xs",className:"w-3 h-3 ml-1"})]})]}),(0,l.jsx)(n.xu,{display:"flex",alignItems:"center",p:2,children:I&&(0,l.jsx)(u.xJ,{children:(0,l.jsxs)(u.iA,{size:"sm",overflowX:"hidden",children:[(0,l.jsx)(u.hr,{children:(0,l.jsx)(u.Tr,{})}),(0,l.jsxs)(u.p3,{children:[(0,l.jsxs)(u.Tr,{children:[(0,l.jsx)(u.Td,{className:"font-semibold",children:"URL"}),(0,l.jsx)(u.Td,{children:g.url})]}),(0,l.jsxs)(u.Tr,{children:[(0,l.jsx)(u.Td,{className:"font-semibold",children:"有効期間"}),(0,l.jsx)(u.Td,{children:null===(t=g.expiry)||void 0===t?void 0:t.toDate().toLocaleString()})]}),(0,l.jsxs)(u.Tr,{children:[(0,l.jsx)(u.Td,{className:"font-semibold",children:"作成日"}),(0,l.jsxs)(u.Td,{children:[g.createdTime.toDate().toLocaleString(),g.createdTime.toDate().toLocaleString()!==g.updatedTime.toDate().toLocaleString()&&(0,l.jsxs)("p",{className:"text-xs text-gray-800 mt-0.5",children:["(更新日:",g.updatedTime.toDate().toLocaleString(),")"]})]})]}),(0,l.jsxs)(u.Tr,{children:[(0,l.jsx)(u.Td,{className:"font-semibold",children:"有効"}),(0,l.jsx)(u.Td,{children:(0,l.jsx)(i.Y8,{size:"md",name:"1",colorScheme:"blue",defaultChecked:g.active,onChange:()=>G(g.id)})})]})]})]})})}),!I&&(0,l.jsxs)(n.xu,{display:"flex",justifyContent:"flex-end",alignItems:"center",className:"h-5 md:h-6",children:[(0,l.jsx)(c.qE,{height:"100%",width:"auto",src:(null==N?void 0:N.photoURL)||"default_image_url"}),(0,l.jsx)("span",{className:"ml-2 text-xs md:text-sm mr-2",children:null==N?void 0:N.displayName})]})]})}},6874:function(e,s,t){"use strict";var l=t(5893),n=t(9008),i=t.n(n),c=t(7294),a=t(1163),r=t(5610);let d=e=>{let{title:s,children:t,isSetUpOGP:n=!0,isTitleHidden:d=!1,isAuthPageHidden:o=!1,loading:x=!1}=e,{push:m}=(0,a.useRouter)();return(0,c.useEffect)(()=>{o&&!x&&m("/signin")},[o,x,m]),(0,l.jsxs)(l.Fragment,{children:[n&&(0,l.jsxs)(i(),{children:[(0,l.jsx)("title",{children:s}),(0,l.jsx)("meta",{property:"og:title",content:s})]}),(0,l.jsxs)("div",{className:"w-[100vw] flex flex-col items-center",children:[!d&&(0,l.jsx)("h1",{className:"text-2xl my-6 font-bold w-[100vw] text-center",children:s}),x&&(0,l.jsx)(r.$,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}),(!o||!x)&&t]})]})};s.Z=d},2038:function(e,s,t){"use strict";t.d(s,{P:function(){return o}});var l=t(5893),n=t(3345),i=t(8641),c=t(9417),a=t(9603),r=t(1163),d=t(4523);let o=e=>{let{user:s,display:t}=e,o=(0,r.useRouter)(),x=(0,d.G)(s);return(0,l.jsx)("div",{className:"w-1/4 flex hidden md:block",children:(0,l.jsxs)("div",{className:"mr-[calc((100%-210px)/2)] ml-[calc((100%-210px)/2+2rem)] flex w-[210px] h-max flex-col items-center justify-center shadow-lg gap-2 mt-12 rounded-md",children:[(0,l.jsx)(n.qE,{flexShrink:0,width:10,height:10,src:(null==s?void 0:s.photoURL)||"default_image_url",mt:4}),(0,l.jsx)("p",{children:null==s?void 0:s.displayName}),(0,l.jsx)(i.iz,{}),(0,l.jsxs)("div",{className:"flex flex-col items-start justify-center gap-2 my-4 px-4",children:[(0,l.jsxs)("button",{className:" flex items-center gap-1.5 ".concat("profile"===t?"text-black":"text-gray-500"),onClick:()=>o.push("/mypage/profile"),children:[(0,l.jsx)(a.G,{icon:c.ILF,size:"xs",className:"h-3 w-3"}),(0,l.jsx)("span",{children:"プロフィール"})]}),(0,l.jsxs)("button",{className:" flex items-center gap-1.5\n              ".concat("posted"===t?"text-black":"text-gray-500","\n            "),onClick:()=>o.push("/mypage/posted"),children:[(0,l.jsx)(a.G,{icon:c.gMD,size:"xs",className:"h-3 w-3"}),(0,l.jsx)("span",{children:"投稿済みアンケート"})]}),(0,l.jsxs)("button",{className:" flex items-center gap-1.5\n              ".concat("answered"===t?"text-black":"text-gray-500","\n            "),onClick:()=>o.push("/mypage/answered"),children:[(0,l.jsx)(a.G,{icon:c.chG,size:"xs",className:"h-3 w-3"}),(0,l.jsx)("span",{children:"回答済みアンケート"})]}),(0,l.jsxs)("button",{className:" flex items-center gap-1.5\n              ".concat("notification"===t?"text-black":"text-gray-500","\n            "),onClick:()=>o.push("/mypage/notification"),children:[(0,l.jsx)(a.G,{icon:c.qmU,size:"xs",className:"h-3 w-3"}),(0,l.jsx)("span",{children:"あなたへのお知らせ"}),x&&(0,l.jsx)("div",{className:"absolute ml-[0.4rem] mb-2 border-white border text-xs md:text-sm text-gray-500 w-[0.6rem] h-[0.6rem] bg-[#38a169] rounded-full"})]})]})]})})}},6799:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});var l=t(9828);let n=async e=>{var s;let t=(0,l.ad)(),n=(0,l.JU)(t,"questionnaires",e);await (0,l.r7)(n,{active:!0});let i=(0,l.hJ)(t,"questionnaires"),c=await (0,l.QT)(n),a=null===(s=c.data())||void 0===s?void 0:s.userId,r=(0,l.IO)(i,(0,l.ar)("userId","==",a)),d=await (0,l.PL)(r);d.forEach(s=>{s.id!==e&&(0,l.r7)(s.ref,{active:!1})})}},9211:function(e,s,t){"use strict";t.r(s),t.d(s,{AnsweredPage:function(){return x}});var l=t(5893),n=t(1734),i=t(1586),c=t(6280),a=t(6874),r=t(2038),d=t(7021),o=t(552);let x=()=>{let{user:e}=(0,n.E)(),{user:s,loading:t}=(0,i.s)(null==e?void 0:e.uid),{answerLogs:x,loading:m}=(0,d.jX)((null==s?void 0:s.email)||""),u=x.map(e=>e.formId),{questionnaires:h,loading:j}=(0,o.o3)(u);return(0,l.jsx)(a.Z,{title:"回答済みアンケート",isTitleHidden:!0,isAuthPageHidden:!s,loading:t||m||j,children:(0,l.jsxs)("div",{className:"w-screen flex ",children:[(0,l.jsx)(r.P,{user:s||void 0,display:"answered"}),(0,l.jsxs)("div",{className:"md:w-3/4 md:p-12 w-full",children:[(0,l.jsx)("h2",{className:"text-xl md:text-2xl font-bold mt-4 text-center",children:"回答済みアンケート"}),(0,l.jsx)("div",{className:"mx-[3%] flex flex-col items-center justify-center gap-2 m-4 w-[94%]",children:h.map(e=>(0,l.jsx)(c.S,{questionnaire:e,user:s||void 0},e.id))})]})]})})};s.default=x}},function(e){e.O(0,[403,774,888,179],function(){return e(e.s=4917)}),_N_E=e.O()}]);