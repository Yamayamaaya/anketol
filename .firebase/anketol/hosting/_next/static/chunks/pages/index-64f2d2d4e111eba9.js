(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(5970)}])},6280:function(e,t,s){"use strict";s.d(t,{S:function(){return g}});var l=s(5893),i=s(8641),n=s(2588),c=s(3345),r=s(9417),a=s(9603),d=s(1586),o=s(7294),x=s(7021),m=s(4221),u=s(6696),h=s(1163),f=s(6799);let j=e=>{let t="".concat("https://script.google.com/macros/s/AKfycbzdlwrxbTb_mfCPvXqIcP5SivAvtEpeRNPGxjeiy9DZwEwJfGFv30RDZhjf-faIm67n/exec","?formId=").concat(e);window.open(t,"_blank")},p=e=>{let t=e.toDate(),s=t.getMonth()+1,l=t.getDate(),i=t.getHours(),n="0".concat(t.getMinutes()).slice(-2);return"".concat(s,"/").concat(l,"  ").concat(i,":").concat(n)};var v=s(9828);let w=()=>{let e=(0,o.useCallback)(async(e,t)=>{let s=(0,v.ad)(),l=(0,v.JU)(s,e,t);try{await (0,v.oe)(l),console.log("Document successfully deleted!")}catch(i){console.error("Error removing document: ",i)}},[]);return e},g=e=>{var t,s;let{questionnaire:v,user:g}=e,{user:b,loading:N}=(0,d.s)(v.userId),{answerLogs:y,loading:T}=(0,x.jX)((null==g?void 0:g.email)||"");(0,o.useEffect)(()=>{},[N,T]);let C=y.some(e=>e.formId===v.id)&&y.length>0,_=(0,m.pm)(),S=(0,h.useRouter)(),E=w(),k=v.userId===(null==g?void 0:g.id),I=async e=>{await E("questionnaires",e),_({title:"削除しました。",status:"success",position:"top"}),S.reload()},D=async e=>{S.push("/questionnaire/edit/".concat(e))},z=async e=>{await (0,f.Z)(e),_({title:"更新しました。",status:"success",position:"top"}),setTimeout(()=>{S.reload()},200)};return(0,l.jsxs)(i.xu,{borderWidth:"1px",borderRadius:"lg",overflow:"hidden",p:4,mb:4,w:"100%",children:[(0,l.jsxs)(i.xu,{p:2,bg:"gray.100",borderRadius:"md",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"ml-2 font-bold text-sm md:text-base",children:v.title}),k?v.isAuthenticated?(0,l.jsx)(i.Ct,{colorScheme:"green",className:"ml-1 mr-6text-xs md:text-sm",children:"認証済"}):(0,l.jsx)(i.Ct,{colorScheme:"red",className:"ml-1 mr-6 ttext-xs md:text-sm",children:"未認証"}):C?(0,l.jsx)(i.Ct,{colorScheme:"green",className:"ml-1 mr-6 ttext-xs md:text-sm",children:"回答済"}):(0,l.jsx)(i.Ct,{colorScheme:"red",className:"ml-1 mr-6 text-xs md:text-sm",children:"未回答"})]}),k?(0,l.jsxs)("div",{className:"flex items-center",children:[v.isAuthenticated?(0,l.jsx)(l.Fragment,{}):(0,l.jsxs)("button",{onClick:()=>j(v.id),className:"flex items-center bg-blue-500 text-white rounded-md px-2 py-1 mr-2 font-semibold text-xs md:text-sm",children:[(0,l.jsx)("span",{children:"認証する"}),(0,l.jsx)(a.G,{icon:r.wlW,size:"xs",className:"w-2.5 ml-1"})]}),(0,l.jsx)("button",{onClick:()=>D(v.id),children:(0,l.jsx)(a.G,{icon:r.Yai,size:"xs",className:"h-3 w-3 mx-2"})}),(0,l.jsx)("button",{onClick:()=>{confirm("削除しますか？")&&I(v.id)},children:(0,l.jsx)(a.G,{icon:r.$aW,size:"xs",className:"h-3 w-3 ml-2"})})]}):C?(0,l.jsxs)("p",{className:"text-xs md:text-sm",children:["回答日時：",p(null===(t=y[0])||void 0===t?void 0:t.createdTime)]}):(0,l.jsxs)("button",{onClick:()=>window.open(v.url,"_blank"),className:"flex items-center bg-blue-500 text-white rounded-md px-2 py-1 text-xs md:text-sm font-semibold",children:[(0,l.jsx)("span",{children:"回答する"}),(0,l.jsx)(a.G,{icon:r.wlW,size:"xs",className:"w-3 h-3 ml-1"})]})]}),(0,l.jsx)(i.xu,{display:"flex",alignItems:"center",p:2,children:k&&(0,l.jsx)(u.xJ,{children:(0,l.jsxs)(u.iA,{size:"sm",overflowX:"hidden",children:[(0,l.jsx)(u.hr,{children:(0,l.jsx)(u.Tr,{})}),(0,l.jsxs)(u.p3,{children:[(0,l.jsxs)(u.Tr,{children:[(0,l.jsx)(u.Td,{className:"font-semibold",children:"URL"}),(0,l.jsx)(u.Td,{children:v.url})]}),(0,l.jsxs)(u.Tr,{children:[(0,l.jsx)(u.Td,{className:"font-semibold",children:"有効期間"}),(0,l.jsx)(u.Td,{children:null===(s=v.expiry)||void 0===s?void 0:s.toDate().toLocaleString()})]}),(0,l.jsxs)(u.Tr,{children:[(0,l.jsx)(u.Td,{className:"font-semibold",children:"作成日"}),(0,l.jsxs)(u.Td,{children:[v.createdTime.toDate().toLocaleString(),v.createdTime.toDate().toLocaleString()!==v.updatedTime.toDate().toLocaleString()&&(0,l.jsxs)("p",{className:"text-xs text-gray-800 mt-0.5",children:["(更新日:",v.updatedTime.toDate().toLocaleString(),")"]})]})]}),(0,l.jsxs)(u.Tr,{children:[(0,l.jsx)(u.Td,{className:"font-semibold",children:"有効"}),(0,l.jsx)(u.Td,{children:(0,l.jsx)(n.Y8,{size:"md",name:"1",colorScheme:"blue",defaultChecked:v.active,onChange:()=>z(v.id)})})]})]})]})})}),!k&&(0,l.jsxs)(i.xu,{display:"flex",justifyContent:"flex-end",alignItems:"center",className:"h-5 md:h-6",children:[(0,l.jsx)(c.qE,{height:"100%",width:"auto",src:(null==b?void 0:b.photoURL)||"default_image_url"}),(0,l.jsx)("span",{className:"ml-2 text-xs md:text-sm mr-2",children:null==b?void 0:b.displayName})]})]})}},6874:function(e,t,s){"use strict";var l=s(5893),i=s(9008),n=s.n(i),c=s(7294),r=s(1163),a=s(5610);let d=e=>{let{title:t,children:s,isSetUpOGP:i=!0,isTitleHidden:d=!1,isAuthPageHidden:o=!1,loading:x=!1}=e,{push:m}=(0,r.useRouter)();return(0,c.useEffect)(()=>{o&&!x&&m("/signin")},[o,x,m]),(0,l.jsxs)(l.Fragment,{children:[i&&(0,l.jsxs)(n(),{children:[(0,l.jsx)("title",{children:t}),(0,l.jsx)("meta",{property:"og:title",content:t})]}),(0,l.jsxs)("div",{className:"w-[100vw] flex flex-col items-center",children:[!d&&(0,l.jsx)("h1",{className:"text-2xl my-6 font-bold w-[100vw] text-center",children:t}),x&&(0,l.jsx)(a.$,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}),(!o||!x)&&s]})]})};t.Z=d},6799:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var l=s(9828);let i=async e=>{var t;let s=(0,l.ad)(),i=(0,l.JU)(s,"questionnaires",e);await (0,l.r7)(i,{active:!0});let n=(0,l.hJ)(s,"questionnaires"),c=await (0,l.QT)(i),r=null===(t=c.data())||void 0===t?void 0:t.userId,a=(0,l.IO)(n,(0,l.ar)("userId","==",r)),d=await (0,l.PL)(a);d.forEach(t=>{t.id!==e&&(0,l.r7)(t.ref,{active:!1})})}},5970:function(e,t,s){"use strict";s.r(t);var l=s(5893),i=s(1734),n=s(1586),c=s(552),r=s(7294),a=s(6280),d=s(6874);let o=()=>{let{user:e}=(0,i.E)(),{user:t}=(0,n.s)(null==e?void 0:e.uid),{questionnaires:s}=(0,c.vx)(),[o,x]=(0,r.useState)(s);return(0,r.useEffect)(()=>{x(s.filter(e=>e.userId!==(null==t?void 0:t.id)&&e.active))},[s,t]),(0,l.jsx)(d.Z,{title:"アンケート一覧",isSetUpOGP:!1,children:(0,l.jsx)("div",{className:"flex flex-col items-center justify-center gap-2 w-full",children:(0,l.jsx)("div",{className:"md:w-3/5 flex flex-col items-center justify-center gap-2 max-w-[530px]",children:o.map((e,s)=>(0,l.jsx)(a.S,{questionnaire:e,user:t||void 0},s))})})})};t.default=o}},function(e){e.O(0,[403,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);