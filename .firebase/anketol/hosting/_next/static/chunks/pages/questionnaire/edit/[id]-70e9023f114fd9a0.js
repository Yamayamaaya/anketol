(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[29],{6608:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/questionnaire/edit/[id]",function(){return s(2158)}])},6799:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(9828);let r=async e=>{var t;let s=(0,a.ad)(),r=(0,a.JU)(s,"questionnaires",e);await (0,a.r7)(r,{active:!0});let l=(0,a.hJ)(s,"questionnaires"),i=await (0,a.QT)(r),n=null===(t=i.data())||void 0===t?void 0:t.userId,c=(0,a.IO)(l,(0,a.ar)("userId","==",n)),u=await (0,a.PL)(c);u.forEach(t=>{t.id!==e&&(0,a.r7)(t.ref,{active:!1})})}},2158:function(e,t,s){"use strict";s.r(t),s.d(t,{Page:function(){return f}});var a=s(5893),r=s(7294),l=s(1163),i=s(8036),n=s(4221),c=s(3234),u=s(979),o=s(9135),d=s(7741),x=s(9198),p=s.n(x);s(5828),s(2490);var h=s(9828),m=s(6799);let f=()=>{let[e,t]=(0,r.useState)({title:"",url:"",expiry:null,active:!1}),[s,x]=(0,r.useState)(""),f=(0,l.useRouter)(),{id:v}=f.query,y=(0,n.pm)();(0,r.useEffect)(()=>{let e=async()=>{let e=(0,i.ad)();if(!v)return;let s=(0,i.JU)(e,"questionnaires",v),a=await (0,i.QT)(s);a.exists()&&t(a.data())};e()},[v]);let N=async t=>{if(t.preventDefault(),j())try{let s=(0,i.ad)(),a=(0,i.JU)(s,"questionnaires",v);v&&(await (0,i.r7)(a,{title:e.title,expiry:e.expiry,url:e.url,updatedTime:new Date}).then(()=>{(0,m.Z)(v)}),f.push("/")),x(""),y({title:"更新しました。",status:"success",position:"top"})}catch(r){y({title:"エラーが発生しました。",status:"error",position:"top"})}},j=()=>""===e.title?(x("タイトルを入力してください"),!1):""===e.url?(x("URLを入力してください"),!1):e.url.match(/^https:\/\/docs.google.com\/forms\/d\/e\/.+\/viewform$/)?null!==e.expiry||(x("有効期限を入力してください"),!1):(x("URLが正しくありません"),!1);return(0,a.jsxs)("div",{className:"flex flex-col items-center py-2",children:[(0,a.jsxs)("form",{onSubmit:N,className:"p-6 mt-6 text-left border w-96 rounded-xl shadow-xl bg-white",children:[(0,a.jsxs)(c.NI,{children:[(0,a.jsx)(c.lX,{className:"pt-3",children:"タイトル"}),(0,a.jsx)(u.II,{type:"text",value:e.title,placeholder:"アンケートタイトル",onChange:s=>t({...e,title:s.target.value})})]}),(0,a.jsxs)(c.NI,{children:[(0,a.jsx)(c.lX,{className:"pt-3",children:"有効期限"}),(0,a.jsx)(p(),{selected:e.expiry?e.expiry.toDate():null,onChange:s=>t({...e,expiry:h.EK.fromDate(s)}),placeholderText:"有効期限",className:"border border-gray-200 rounded-md w-[20.8rem] py-2 pl-2"})]}),(0,a.jsxs)(c.NI,{children:[(0,a.jsx)(c.lX,{className:"pt-3",children:"URL"}),(0,a.jsx)(u.II,{type:"text",placeholder:"googleフォームのURL",value:e.url,onChange:s=>t({...e,url:s.target.value})})]}),(0,a.jsxs)(c.NI,{children:[(0,a.jsx)(c.lX,{className:"pt-3",children:"有効"}),(0,a.jsx)(o.XZ,{isChecked:e.active,onChange:s=>t({...e,active:s.target.checked})}),e.active?(0,a.jsx)("p",{className:"text-gray-500 text-sm ",children:"※他のアンケートを無効にします"}):(0,a.jsx)(a.Fragment,{})]}),(0,a.jsx)(d.zx,{type:"submit",className:"mt-6",children:"更新"})]}),(0,a.jsx)("p",{className:"mt-6 text-red-500",children:s})]})};t.default=f}},function(e){e.O(0,[732,774,888,179],function(){return e(e.s=6608)}),_N_E=e.O()}]);