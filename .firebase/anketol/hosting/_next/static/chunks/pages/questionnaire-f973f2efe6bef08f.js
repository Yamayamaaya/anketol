(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[905],{7541:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/questionnaire",function(){return r(3972)}])},6799:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var l=r(9828);let a=async e=>{var t;let r=(0,l.ad)(),a=(0,l.JU)(r,"questionnaires",e);await (0,l.r7)(a,{active:!0});let s=(0,l.hJ)(r,"questionnaires"),i=await (0,l.QT)(a),n=null===(t=i.data())||void 0===t?void 0:t.userId,c=(0,l.IO)(s,(0,l.ar)("userId","==",n)),u=await (0,l.PL)(c);u.forEach(t=>{t.id!==e&&(0,l.r7)(t.ref,{active:!1})})}},3972:function(e,t,r){"use strict";r.r(t),r.d(t,{Page:function(){return w}});var l=r(5893),a=r(7294),s=r(8036),i=r(4444),n=r(4221),c=r(3234),u=r(979),o=r(9135),d=r(7741),p=r(9198),x=r.n(p);r(5828),r(2490);var h=r(1734),m=r(9828),f=r(1163),v=r(6799);let w=()=>{let[e,t]=(0,a.useState)({title:"",url:"",expiry:null,active:!1}),[r,p]=(0,a.useState)(""),{user:w}=(0,h.E)(),j=(0,f.useRouter)(),y=(0,n.pm)(),N=async r=>{r.preventDefault();let l=await g();if(!l)return;let a=await _(e.url);try{let n=(0,s.ad)(),c=(0,s.hJ)(n,"questionnaires");if(w&&a){let u=w.uid,o=(0,s.JU)(c,a);await (0,s.pl)(o,{title:e.title,expiry:e.expiry,url:e.url,userId:u,createdTime:new Date,updatedTime:new Date}).then(()=>{(0,v.Z)(a)}),j.push("/")}t({title:"",url:"",expiry:null,active:!1}),p(""),y({title:"投稿しました。",status:"success",position:"top"})}catch(d){d instanceof i.ZR&&(console.error("Firebase Error",d),y({title:"エラーが発生しました。",status:"error",position:"top"}))}},g=()=>""===e.title?(p("タイトルを入力してください"),!1):null===e.expiry?(p("有効期限を入力してください"),!1):""===e.url?(p("URLを入力してください"),!1):!!e.url.match(/^https:\/\/docs.google.com\/forms\/d\/e\/.+\/viewform$/)||!e.url.split("/")[6]||(p("URLが正しくありません"),!1),_=e=>{let t=e.split("/")[6];return t};return(0,l.jsxs)("div",{className:"flex flex-col items-center py-2",children:[(0,l.jsxs)("form",{onSubmit:N,className:"p-6 mt-6 text-left border w-96 rounded-xl shadow-xl bg-white",children:[(0,l.jsxs)(c.NI,{children:[(0,l.jsx)(c.lX,{children:"タイトル"}),(0,l.jsx)(u.II,{type:"text",value:e.title,placeholder:"アンケートタイトル",onChange:r=>t({...e,title:r.target.value})})]}),(0,l.jsxs)(c.NI,{children:[(0,l.jsx)(c.lX,{className:"pt-3",children:"有効期限"}),(0,l.jsx)(x(),{selected:e.expiry?e.expiry.toDate():null,onChange:r=>t({...e,expiry:m.EK.fromDate(r)}),placeholderText:"有効期限",className:"border border-gray-200 rounded-md w-[20.8rem] py-2 pl-2"})]}),(0,l.jsxs)(c.NI,{children:[(0,l.jsx)(c.lX,{className:"pt-3",children:"URL"}),(0,l.jsx)(u.II,{type:"text",placeholder:"googleフォームのURL",value:e.url,onChange:r=>t({...e,url:r.target.value})})]}),(0,l.jsxs)(c.NI,{children:[(0,l.jsx)(c.lX,{className:"pt-3",children:"有効"}),(0,l.jsx)(o.XZ,{isChecked:e.active,onChange:r=>t({...e,active:r.target.checked})}),e.active?(0,l.jsx)("p",{className:"text-gray-500 text-sm ",children:"※他のアンケートを無効にします"}):(0,l.jsx)(l.Fragment,{})]}),(0,l.jsx)(d.zx,{type:"submit",className:"mt-6",children:"投稿"})]}),(0,l.jsx)("p",{className:"mt-6 text-red-500",children:r})]})};t.default=w}},function(e){e.O(0,[732,774,888,179],function(){return e(e.s=7541)}),_N_E=e.O()}]);